<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Äî SyntaxDuel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="shared/auth.css">
</head>
<body>

<div class="auth-wrapper">
  <div class="auth-card">
    <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
    <p class="auth-subtitle">–°–æ–∑–¥–∞–π –∞–∫–∫–∞—É–Ω—Ç üåÄ</p>

    <form id="registerForm">
      <div class="input-group">
        <input type="text" name="name" required>
        <label>–ò–º—è –∏–ª–∏ –Ω–∏–∫</label>
      </div>

      <div class="input-group">
        <input type="email" name="email" required>
        <label>–ü–æ—á—Ç–∞</label>
      </div>

      <div class="input-group">
        <input type="password" name="password" required>
        <label>–ü–∞—Ä–æ–ª—å</label>
      </div>

      <button class="auth-btn primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </form>

    <p class="auth-footer">
      –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="login.html">–í–æ–π—Ç–∏</a>
    </p>
  </div>
</div>

<script>
document.getElementById("registerForm").addEventListener("submit", async e => {
  e.preventDefault();

  const name = e.target.name.value;
  const email = e.target.email.value;
  const password = e.target.password.value;

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è
  if (password.length < 8) {
    alert("–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤!");
    return; // –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã
  }

  const res = await fetch("http://localhost:3000/api/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, email, password })
  });

  const data = await res.json();

  if (data.success) {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î
    localStorage.setItem("user", JSON.stringify(data.user));
    location.href = "index.html";
  } else {
    alert(data.error);
  }
});
</script>

</body>
</html>
